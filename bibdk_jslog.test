<?php

class BibdkJsLogUnitTestCase extends DrupalUnitTestCase {

  public static function getInfo() {
    return array(
      'name' => 'bibliotek.dk - jslog unit test',
      'description' => 'Test methods in bibdk_jslog',
      'group' => 'Bibliotek.dk-jslog',
    );
  }

  public function setUp() {
    module_load_include('module', 'bibdk_jslog');
    parent::setUp();
  }

  // test bibdk_jslog_sanitize_post method (TingClientRequest.php)
  public function testSanitizePost() {
    // valid $_POST
    $this->validPost();
    $params = bibdk_jslog_sanitize_post();
    $this->assertTrue(count($params) == 5);
    // empty $_POST
    $this->emptyPost();
    $params = bibdk_jslog_sanitize_post();
    $this->assertTrue(empty($params));    
    // wrong types
    $this->wrongPost();
    $params = bibdk_jslog_sanitize_post();
    $this->assertTrue(count($params) == 2);    
  }

  private function emptyPost() {
    $_POST = array();
  }

  private function validPost() {
    $_POST = array(
    'type' => 'HEST',
    'message' => 'HEj med dig',
    'variables' => array(),
    'severity' => '2',
    'link' => 'http://gogle.dk',
    );
  }
  
  private function wrongPost(){
    $_POST = array(
      //invalid type (should be string)
    'type' => 1,
      // invalid type (should be string)
    'message' => 26,
      // invalid type (should be array)
    'variables' => 'TESTHEST',
    'severity' => '2',
    'link' => 'http://gogle.dk',
    );
  }

}

?>